# Phase 1 Implementation Plan (H0 ‚Äì H24)

The objective of Phase 1 is to ship an end-to-end ‚Äúhappy-path‚Äù demo that proves the core value: a new user can sign up (email + LinkedIn), define an ideal persona, receive ‚â•1 match (mock scored), accept an autogenerated ice-breaker, and chat inside the web app.

---

## 0. Legend

| Symbol | Meaning                          |
|--------|----------------------------------|
| ‚ö°     | Critical-path item               |
| üîπ     | Stub (temporary)                 |
| ‚úÖ    | Validation gate (must pass)       |

Time marks assume **H0 = repo bootstrap**.

---

## 1. Hour-by-Hour Breakdown

| Hour | Deliverable / Activity | Build vs Stub | Validation |
|------|-----------------------|---------------|------------|
| **H0-1** | ‚Ä¢ Git repo clone<br>‚Ä¢ Environment bootstrap (`make docker-up`) | _n/a_ | ‚úÖ Local stack up, `localhost:3000/graphql` returns `__schema` |
| **H1-3 ‚ö°** | **Auth Service**<br>‚Ä¢ Email + password register/login<br>‚Ä¢ LinkedIn OAuth callback route (stub UI redirect) | Build | ‚úÖ `POST /api/auth/login` returns JWT and refresh token |
| **H3-4** | **Gateway wiring**<br>‚Ä¢ Forward `/graphql` auth context to Auth svc | Build | ‚úÖ GraphQL `me` query returns user object |
| **H4-6 ‚ö°** | **Profile Service**<br>‚Ä¢ CRUD for `UserProfile` + `IdealPersona` | Build | ‚úÖ Mutation `updateIdealPersona` persists & query returns new values |
| **H6-8** | **Next.js Onboarding UI**<br>‚Ä¢ Email/LinkedIn sign-in page<br>‚Ä¢ 3-step persona wizard | Build | ‚úÖ User can complete wizard; data visible in GraphQL |
| **H8-10 ‚ö°** | **Match Engine v0**<br>‚Ä¢ Nightly cron stub (manual trigger)<br>‚Ä¢ Cosine similarity on random embeddings via `faker`<br>‚Ä¢ Write `matches` rows | Build (logic) + üîπ mock embeddings | ‚úÖ Query `myMatches` returns ‚â•1 match with `PENDING` status |
| **H10-11** | **Conversation Service**<br>‚Ä¢ POST `/icebreakers` endpoint that calls OpenAI API  *(or mock if no key)* | Build + üîπ mock LLM | ‚úÖ Match now has `icebreaker` text |
| **H11-12** | **Gateway resolvers** for matches & icebreakers | Build | ‚úÖ GraphQL `icebreakerCreated` subscription fires in Playground |
| **H12-14 ‚ö°** | **Chat MVP**<br>‚Ä¢ REST `/messages` (in-memory) + GraphQL relay<br>‚Ä¢ Front-end chat panel (simple list) | Build | ‚úÖ User can send a message, receiver sees it (same browser incognito) |
| **H14-15** | **Docker Compose healthchecks** for new services | Build | ‚úÖ `docker compose ps` shows **healthy** for auth, profile, match, conversation |
| **H15-17 ‚ö°** | **Mock Data Injection Scripts**<br>‚Ä¢ `scripts/seed-mock-data.ts` fills 50 users/personas<br>‚Ä¢ GitHub/Twitter/Crunchbase fixtures dropped into `mock-data/` | Build | ‚úÖ `make db-seed` finishes; `users` count = 50 |
| **H17-18** | **Load Test Smoke** (`k6 10VU 5s`) | Build | ‚úÖ p95 <1500 ms, no 5xx |
| **H18-20 ‚ö°** | **Frontend Polish**<br>‚Ä¢ Match cards grid<br>‚Ä¢ Accept icebreaker CTA<br>‚Ä¢ Simple chat auto-scroll | Build | ‚úÖ Click ‚ÄúStart Chat‚Äù ‚Üí chat view opens with icebreaker pre-filled |
| **H20-21** | **Telemetry**<br>‚Ä¢ Prometheus counters for `/api/auth/login_success_total` and GraphQL `matchCreated` | Build | ‚úÖ Prometheus target up, metrics visible |
| **H21-22** | **CI pipeline smoke**<br>‚Ä¢ Run lint+unit tests in GitHub Action | Build | ‚úÖ PR check green |
| **H22-23** | **Staging Helm manifest (minikube / kind)**<br>‚Ä¢ Gateway + Auth only | Build | ‚úÖ `kubectl get pods` all running; `/readyz` OK |
| **H23-24 ‚ö°** | **Demo Script + Checklist**<br>‚Ä¢ Record loom walk-through<Br>‚Ä¢ Update README quick-start | Build | ‚úÖ Stakeholder signs off ‚ÄúPhase 1 complete‚Äù |

---

## 2. Coding Order (Service-first vertical slice)

1. `services/auth` (extend existing)
2. `gateway` JWT context plumbing
3. `services/profile`
4. `services/match-engine v0`
5. `services/conversation`
6. `frontend/onboarding`
7. `frontend/match-list + chat`
8. Seed script & telemetry

---

## 3. Mock Data Setup

1. **Directory layout**
   ```
   mock-data/
     linkedin/*.json
     github/*.json
     twitter/*.json
     crunchbase/*.json
   scripts/seed-mock-data.ts
   ```
2. **Env flag**
   ```
   USE_MOCK_DATA=true            # default for local & CI
   ```
3. **Seed Command**
   ```bash
   make db-reset          # recreates schema
   make db-seed           # invokes seed-mock-data.ts
   ```
4. **Pattern**
   ```ts
   if (getEnvBoolean('USE_MOCK_DATA')) {
     return require('../../mock-data/linkedin/profile.json');
   }
   ```

---

## 4. Critical-Path Items (must not slip)

| # | Item | Reason |
|---|------|--------|
| 1 | Auth register/login & JWT | All subsequent calls gated |
| 2 | Persona form save | Needed for match algorithm |
| 3 | Match Engine writes rows | Core product promise |
| 4 | Icebreaker generator | Conversation ignition metric |
| 5 | Chat relay | Demonstrates utility |
| 6 | Mock seed script | Allows instant match density for demo |

---

## 5. Build vs. Stub Matrix

| Feature | Phase 1 Action |
|---------|----------------|
| Email + LinkedIn auth | **Build** |
| GitHub/Twitter/Crunchbase ingestion | üîπ **Stub** with fixtures |
| Match embedding vectors | üîπ Random vectors via `faker` |
| Icebreaker generation | Build if `OPENAI_API_KEY` present else üîπ static templates |
| Venue recommender | üîπ Hard-coded list (‚ÄúBlue Bottle Coffee‚Äù, ‚ÄúPhilz‚Äù) |
| Voice interface | üîπ No-op WS handler |
| Safety checks | üîπ Button disabled |

---

## 6. Validation Criteria per Milestone

| Milestone | Tests / Checks |
|-----------|----------------|
| Auth live | Unit test `POST /login` 200; JWT verifies |
| Persona saved | GraphQL query `idealPersona` returns updated fields |
| Match rows created | SQL `SELECT count(*) FROM matches WHERE status='PENDING'` ‚â•1 for seed user |
| Icebreaker linked | `matches.icebreaker_id` IS NOT NULL |
| Chat message | WebSocket subscription `messageReceived` emits payload |
| Prometheus | `curl localhost:9090/metrics | grep auth_login_success_total` shows increment |
| Load smoke | k6 script passes thresholds |

---

## 7. Common Blockers & Solutions

| Blocker | Likely Cause | Quick Fix |
|---------|--------------|-----------|
| Docker service unhealthy | Port clash / env var missing | `docker compose logs <svc>`; kill process; check `.env` |
| LinkedIn OAuth 401 | Bad redirect URI | Ensure ‚Äúhttp://localhost:3000/api/auth/linkedin/callback‚Äù in LinkedIn app |
| Prisma/PG connection refused | Postgres not ready | Add `depends_on:postgres` + healthcheck retries |
| CORS errors in Next.js | Missing `credentials:true` or origin | Update `corsOptions` in gateway |
| GraphQL `depthLimit` kicking queries | UI nesting too deep | Increase limit to 10 for dev, add pagination |
| Seed script duplicates key | Unique constraint on email | `ON CONFLICT DO NOTHING` or use `faker.internet.email()` |

---

## 8. Deliverables Checklist (End of H24)

- [ ] README quick-start updated  
- [ ] Phase 1 doc (this file) committed  
- [ ] Loom/video demo recorded  
- [ ] CI green on PR  
- [ ] Staging namespace live (`/readyz` green)  
- [ ] Prometheus & Grafana dashboards show traffic  

---

Happy hacking ‚Äì see you at **H24 demo**! üéâ
